<!DOCTYPE html>
<html lang="pt-BR">
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Catálogo de Filmes Fase 2: Consumo de API</title>

     <link rel="stylesheet" href="style.css">

</head>
<body>    

    <h1>Catálogo de Filmes</h1>

    <form id="cadastro-filme">
    <h2>Adicionar Novo Filme (Busca por API)</h2>
    <div>
        <label for="titulo">Título do Filme: </label>
        <input type="text" id="titulo" required>
        </div>

        <button type="submit">Buscar e adicionar Filme</button>
        </form>
       
<hr>

<h2>Minha Lista de Filmes</h2>

<div id="lista-filmes">
     <p>Nenhum filme cadastrado ainda.</p>
</div>

<script>
     // A chave secreta da API omdb (Substitua esta string pela sua chave real!)
     const API_KEY = ' sua_chave_omba_aqui';

    // 1. ARMAZENAMENTO DE DADOS
    const catalogo = [];

   // 2. CAPTURA DE ELEMENTOS DO DOM (Document Object Model)
   const form = document.getElementById('cadastro-filme');
   const tituloinput = document.getElementByld('titulo');
   const listaFilmesContainer = document.getElementById('lista-filmes');

   //------------------------------------------------------------------------------------------
   // FUNÇÃO DE REMOÇÃO
   //------------------------------------------------------------------------------------------
    function removerFilme (indice, elementoDOM) {
        catalogo.splice(indice, 1);
        elementoDOM.remove();
       
        if (catalogo.length === 0) {
              listaFilmesContainer.innerHTML = '<p>Nenhum filme cadastrado ainda.</p>';
        }

        // CORREÇÃO 5: Corrigido o console.log (uso de template string: crases e ${})
        console.log(`Filme no indice ${indice} removido. Catálogo atualizado:`, catalogo);
    }

   //-------------------------------------------------------------------------------------
   //FUNÇÃO RENDERIZAÇÃO
   //-------------------------------------------------------------------------------------
function renderizarFilme (filme, indice) {
   if (catalogo.length === 1) {
       listaFilmesContainer.innerHTML = '';
}

     const filmeDiv = document.createElement('div');
     filmeDiv.classList.add('filme-item'); 

     // Cria o <h3> para o titulo e define seu texto.
     // CORREÇÃO 2: Tag "3" -> "h3"
     const tituloH3 = document.createElement("h3");
     // CORREÇÃO 3: Faltou o sinal de atribuição (=)
     tituloH3.textContent = filme.titulo;

     // Cria o <p> para a sinopse e define seu texto.
     const sinopseP = document.createElement('p'); // Correção: 'sinopsep' -> 'sinopseP'
     sinopseP.textContent = filme.sinopse;

     // Cria o botão de remoção.
     const removerBotao = document.createElement('button');
     removerBotao.textContent = 'Remover';
     removerBotao.classList.add('btn-remover');
     
     // B. DEFINIÇÃO DO EVENTO DE REMOÇÃO (addEventListener)
     // Anexa a função 'removerFilme' ao clique do botão.
     removerBotao.addEventListener('click', () => {
           // Ao clicar, chamamos a função, passando o indice (posição) e a propria <div> (filmeDiv)
            removerFilme (indice, filmeDiv);
});
    // C. ANEXAR ELEMENTOS (appendChild)
     // Monta a estrutura hierárquica:
     // filmeDiv
     // | - tituloH3
     // | - sinopseP
     // | - removerBotao
     filmeDiv.appendChild(tituloH3);
     filmeDiv.appendChild(sinopseP); // Correção: 'sinopsep' -> 'sinopseP'
     filmeDiv.appendChild(removerBotao);
     
       // D. INSERÇÃO NO DOM FINAL
       // Adiciona o filme montado (filmeDiv) dentro do container principal na página.
    listaFilmesContainer.appendChild(filmeDiv); // Correção: 'listaFilmes Container' -> 'listaFilmesContainer'
}
     //
       // FUNÇÃO PRINCIPAL DE ADIÇÃO (Manipulador do Formulario)
     /** Lida com o envio do formulario, captura os dados e salva o filme.
     * @param {Event} evento O evento de 'submit' do formulario.
     */
     function adicionarFilme (evento) {
       // 3. Previne o recarregamento da página
       // O comportamento padrão de um formulario é recarregar a página. O preventDefault() impede isso.
     evento.preventDefault();
       // 4. Captura os valores dos campos
       // CORREÇÃO 6: Removido o preventDefault() duplicado.
       // O comportamento padrão de um formulário é recarregar pagina. O preventDefault() impede isso.
       // evento.preventDefault(); 
       // 4. Captura os valores dos campos
     
       const tituloInput = document.getElementById('titulo');
     const sinopseInput = document.getElementById('sinopse');
       // Cria o objeto JavaScript com os dados
     
       const novoFilme = {
       titulo: tituloInput.value,
       sinopse: sinopseInput.value
};

     //5. Armazena o filme no Array
     // O método.push() adiciona o novo objeto no final do array 'catalogo'.
     catalogo.push (novoFilme);
     // 6. Renderiza na Tela
     // Passamos o novo objeto e seu indice (que sempre o último, ou seja, tamanho - 1)
     renderizarFilme (novoFilme, catalogo.length - 1);

     
     // 7. Limpa o formulario
     // O método .reset() limpa todos os campos do formulario para o proximo cadastro.
     form.reset();
}
     
     
     // 8. ESCUTANDO O EVENTO DO BOTÃO/FORMULARIO
     // Anexamos a função adicionarFilme ao evento de 'submit' do formulario.
     form.addEventListener('submit', adicionarFilme);

     console.log("JavaScript Carregado. Pronto para iniciar o catálogo!");
</script>

</body>
</html>